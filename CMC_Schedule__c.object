<?xml version="1.0" encoding="UTF-8"?>
<CustomObject xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionOverrides>
        <actionName>Accept</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Clone</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Delete</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Edit</actionName>
        <content>CMC_Edit_Schedule</content>
        <type>Visualforce</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>List</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>New</actionName>
        <content>CMC_Edit_Schedule</content>
        <type>Visualforce</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Tab</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>View</actionName>
        <type>Default</type>
    </actionOverrides>
    <deploymentStatus>Deployed</deploymentStatus>
    <description>Schedules for running CMC Cloud Metrics &amp; Monitors jobs</description>
    <enableActivities>false</enableActivities>
    <enableEnhancedLookup>false</enableEnhancedLookup>
    <enableFeeds>false</enableFeeds>
    <enableHistory>true</enableHistory>
    <enableReports>true</enableReports>
    <fields>
        <fullName>Account_Id__c</fullName>
        <description>Account Id</description>
        <externalId>false</externalId>
        <formula>Connection_Rel__r.Account_Id__r.Id</formula>
        <inlineHelpText>Account Id</inlineHelpText>
        <label>Account Id</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>Account__c</fullName>
        <description>Account Name</description>
        <externalId>false</externalId>
        <formula>Connection_Rel__r.Account_Id__r.Name</formula>
        <inlineHelpText>Account Name</inlineHelpText>
        <label>Account</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>Collect_Code_Metrics__c</fullName>
        <defaultValue>false</defaultValue>
        <description>Collect code/configuration metrics concerning Apex Classes/Triggers and Custom Objects in the Salesforce.com org represented by this connection.</description>
        <externalId>false</externalId>
        <inlineHelpText>Collect code/configuration metrics concerning Apex Classes/Triggers and Custom Objects in the Salesforce.com org represented by this connection.</inlineHelpText>
        <label>Collect Code Metrics</label>
        <trackHistory>true</trackHistory>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>Collect_Mail_Forwarding_Setting__c</fullName>
        <defaultValue>false</defaultValue>
        <description>Collect mail forwarding information metrics for users in the Google Apps domain represented by this connection.  Users who have configured their email account to forward all messages to an external domain will be identified.</description>
        <externalId>false</externalId>
        <inlineHelpText>Collect mail forwarding information metrics for users in the Google Apps domain represented by this connection.  Users who have configured their email account to forward all messages to an external domain will be identified.</inlineHelpText>
        <label>Collect Mail Forwarding Setting</label>
        <trackHistory>false</trackHistory>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>Collect_Public_Documents__c</fullName>
        <defaultValue>false</defaultValue>
        <description>Collect the published status for documents in the Google Apps domain represented by this connection.  Published documents available outside the user&apos;s domain will be identified.</description>
        <externalId>false</externalId>
        <inlineHelpText>Collect the published status for documents in the Google Apps domain represented by this connection.  Published documents available outside the user&apos;s domain will be identified.</inlineHelpText>
        <label>Collect Public Documents</label>
        <trackHistory>false</trackHistory>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>Collect_Test_Coverage_Metrics__c</fullName>
        <defaultValue>false</defaultValue>
        <description>Collect Apex test coverage metrics concerning % coverage and number of passed/failed test methods in the Salesforce.com org represented by this connection.</description>
        <externalId>false</externalId>
        <inlineHelpText>Collect Apex test coverage metrics concerning % coverage and number of passed/failed test methods in the Salesforce.com org represented by this connection.</inlineHelpText>
        <label>Collect Test Coverage Metrics</label>
        <trackHistory>true</trackHistory>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>Connection_Rel__c</fullName>
        <description>Connection to use when running this scheduled job.</description>
        <externalId>false</externalId>
        <inlineHelpText>Connection to use when running this scheduled job.</inlineHelpText>
        <label>Connection</label>
        <referenceTo>CMC_Connection__c</referenceTo>
        <relationshipName>Schedules_Rel</relationshipName>
        <relationshipOrder>0</relationshipOrder>
        <trackHistory>true</trackHistory>
        <type>MasterDetail</type>
        <writeRequiresMasterRead>false</writeRequiresMasterRead>
    </fields>
    <fields>
        <fullName>Cron_Expression__c</fullName>
        <description>Cron expression for this schedule.  This is automatically generated based on user input.</description>
        <externalId>false</externalId>
        <inlineHelpText>Cron expression for this schedule.  This is automatically generated based on user input.</inlineHelpText>
        <label>Cron Expression</label>
        <length>128</length>
        <required>false</required>
        <trackHistory>true</trackHistory>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>Email_Addresses__c</fullName>
        <description>Comma delimited list of email addresses who will be getting alerted if this monitor hits its warning threshold.</description>
        <externalId>false</externalId>
        <inlineHelpText>Comma delimited list of email addresses who will be getting alerted if this monitor hits its warning threshold.</inlineHelpText>
        <label>Email Addresses</label>
        <required>false</required>
        <trackHistory>true</trackHistory>
        <type>TextArea</type>
    </fields>
    <fields>
        <fullName>Execution_SOQL__c</fullName>
        <defaultValue>&quot;SELECT id FROM Contact LIMIT 1000&quot;</defaultValue>
        <description>SOQL for monitor to execute for this connection.</description>
        <externalId>false</externalId>
        <inlineHelpText>SOQL for monitor to execute for this connection.</inlineHelpText>
        <label>Execution SOQL</label>
        <length>32768</length>
        <trackHistory>true</trackHistory>
        <type>LongTextArea</type>
        <visibleLines>10</visibleLines>
    </fields>
    <fields>
        <fullName>Frequency__c</fullName>
        <description>Frequency that the job is scheduled to run.</description>
        <externalId>false</externalId>
        <inlineHelpText>Frequency that the job is scheduled to run.</inlineHelpText>
        <label>Frequency</label>
        <picklist>
            <picklistValues>
                <fullName>Daily</fullName>
                <default>true</default>
            </picklistValues>
            <picklistValues>
                <fullName>Every 10 Minutes</fullName>
                <default>false</default>
            </picklistValues>
            <sorted>false</sorted>
        </picklist>
        <trackHistory>true</trackHistory>
        <type>Picklist</type>
    </fields>
    <fields>
        <fullName>Google_Identify_Stagnant_Accounts__c</fullName>
        <defaultValue>false</defaultValue>
        <description>Identify Google Apps accounts that have not been access for more than 30 days.</description>
        <externalId>false</externalId>
        <inlineHelpText>Identify Google Apps accounts that have not been access for more than 30 days.</inlineHelpText>
        <label>Identify Stagnant Accounts</label>
        <trackHistory>false</trackHistory>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>Last_Run_Status__c</fullName>
        <description>Status of the last time this scheduled job was run.</description>
        <externalId>false</externalId>
        <inlineHelpText>Status of the last time this scheduled job was run.</inlineHelpText>
        <label>Last Run Status</label>
        <picklist>
            <picklistValues>
                <fullName>Completed</fullName>
                <default>false</default>
            </picklistValues>
            <picklistValues>
                <fullName>Failed</fullName>
                <default>false</default>
            </picklistValues>
            <picklistValues>
                <fullName>In Progress</fullName>
                <default>false</default>
            </picklistValues>
            <picklistValues>
                <fullName>Timeout</fullName>
                <default>false</default>
            </picklistValues>
            <picklistValues>
                <fullName>Success</fullName>
                <default>false</default>
            </picklistValues>
            <picklistValues>
                <fullName>Error</fullName>
                <default>false</default>
            </picklistValues>
            <sorted>false</sorted>
        </picklist>
        <trackHistory>true</trackHistory>
        <type>Picklist</type>
    </fields>
    <fields>
        <fullName>Last_Successful_Rundate__c</fullName>
        <description>It is used to set last successful date-time of schedule.</description>
        <externalId>false</externalId>
        <inlineHelpText>Date that this schedule last ran successfully.</inlineHelpText>
        <label>Last Successful Date</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <type>DateTime</type>
    </fields>
    <fields>
        <fullName>Num_Failures__c</fullName>
        <defaultValue>0</defaultValue>
        <description>It is used to count number of contiguous failures.It would restart from 0 with succesfull schedule.</description>
        <externalId>false</externalId>
        <inlineHelpText>Number of times in a row that this schedule failed.</inlineHelpText>
        <label># of Successive Failures</label>
        <precision>2</precision>
        <required>false</required>
        <scale>0</scale>
        <trackHistory>false</trackHistory>
        <type>Number</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>Registered_State__c</fullName>
        <description>Current state of this scheduled job in AWS.</description>
        <externalId>false</externalId>
        <inlineHelpText>Current state of this scheduled job.</inlineHelpText>
        <label>Registered State</label>
        <picklist>
            <picklistValues>
                <fullName>InActive</fullName>
                <default>false</default>
            </picklistValues>
            <picklistValues>
                <fullName>Active</fullName>
                <default>false</default>
            </picklistValues>
            <sorted>false</sorted>
        </picklist>
        <trackHistory>true</trackHistory>
        <type>Picklist</type>
    </fields>
    <fields>
        <fullName>Schedule_Name__c</fullName>
        <description>Name of the scheduled job.</description>
        <externalId>false</externalId>
        <formula>Connection_Rel__r.Name  + &quot; &quot; + $RecordType.Name</formula>
        <inlineHelpText>Name of the scheduled job.</inlineHelpText>
        <label>Schedule Name</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <label>Schedule</label>
    <listViews>
        <fullName>All</fullName>
        <columns>NAME</columns>
        <columns>Connection_Rel__c</columns>
        <columns>Frequency__c</columns>
        <columns>RECORDTYPE</columns>
        <filterScope>Everything</filterScope>
        <label>All</label>
        <language>en_US</language>
    </listViews>
    <listViews>
        <fullName>Failed</fullName>
        <columns>NAME</columns>
        <columns>Connection_Rel__c</columns>
        <columns>Frequency__c</columns>
        <columns>RECORDTYPE</columns>
        <columns>Cron_Expression__c</columns>
        <columns>Registered_State__c</columns>
        <columns>Last_Run_Status__c</columns>
        <filterScope>Everything</filterScope>
        <filters>
            <field>Last_Run_Status__c</field>
            <operation>equals</operation>
            <value>Failed</value>
        </filters>
        <filters>
            <field>Registered_State__c</field>
            <operation>notEqual</operation>
            <value>InActive</value>
        </filters>
        <label>Currently Failing Jobs</label>
        <language>en_US</language>
        <sharedTo>
            <groups>Appirio: CMC Engineering</groups>
        </sharedTo>
    </listViews>
    <listViews>
        <fullName>Running</fullName>
        <columns>NAME</columns>
        <columns>Connection_Rel__c</columns>
        <columns>Frequency__c</columns>
        <columns>RECORDTYPE</columns>
        <columns>Cron_Expression__c</columns>
        <columns>Registered_State__c</columns>
        <columns>Last_Run_Status__c</columns>
        <filterScope>Everything</filterScope>
        <filters>
            <field>Last_Run_Status__c</field>
            <operation>equals</operation>
            <value>In Progress</value>
        </filters>
        <filters>
            <field>Registered_State__c</field>
            <operation>notEqual</operation>
            <value>InActive</value>
        </filters>
        <label>Currently Running Jobs</label>
        <language>en_US</language>
        <sharedTo>
            <groups>Appirio: CMC Engineering</groups>
        </sharedTo>
    </listViews>
    <listViews>
        <fullName>X4pm_CST</fullName>
        <booleanFilter>1 OR 2 OR 3</booleanFilter>
        <columns>NAME</columns>
        <columns>Connection_Rel__c</columns>
        <columns>Account__c</columns>
        <columns>Frequency__c</columns>
        <columns>RECORDTYPE</columns>
        <columns>Cron_Expression__c</columns>
        <columns>Registered_State__c</columns>
        <columns>Last_Run_Status__c</columns>
        <columns>CREATEDBY_USER</columns>
        <columns>UPDATEDBY_USER</columns>
        <filterScope>Everything</filterScope>
        <filters>
            <field>OBJECT_ID</field>
            <operation>equals</operation>
            <value>a2Y50000000GmgM,a2Y50000000Gmoa,a2Y50000000Gmof,a2Y50000000GmoG</value>
        </filters>
        <filters>
            <field>OBJECT_ID</field>
            <operation>equals</operation>
            <value>a2Y50000000GmsX,a2Y50000000Gmwo,a2Y50000000Gmzd,a2Y50000000Gmzi</value>
        </filters>
        <filters>
            <field>OBJECT_ID</field>
            <operation>equals</operation>
            <value>a2Y50000000Gn1e,a2Y50000000Gn73</value>
        </filters>
        <label>4pm CST</label>
        <language>en_US</language>
        <sharedTo>
            <groups>Appirio: CMC Engineering</groups>
        </sharedTo>
    </listViews>
    <nameField>
        <displayFormat>SC-{0}</displayFormat>
        <label>Schedule Number</label>
        <trackHistory>false</trackHistory>
        <type>AutoNumber</type>
    </nameField>
    <pluralLabel>Schedules</pluralLabel>
    <recordTypeTrackHistory>true</recordTypeTrackHistory>
    <recordTypes>
        <fullName>CMC_Google_Metrics</fullName>
        <active>true</active>
        <description>Daily collection of Google Apps configuration metrics</description>
        <label>Google Metrics</label>
        <picklistValues>
            <picklist>Frequency__c</picklist>
            <values>
                <fullName>Daily</fullName>
                <default>true</default>
            </values>
            <values>
                <fullName>Every 10 Minutes</fullName>
                <default>false</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>Last_Run_Status__c</picklist>
            <values>
                <fullName>Completed</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>Error</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>Failed</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>In Progress</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>Success</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>Timeout</fullName>
                <default>false</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>Registered_State__c</picklist>
            <values>
                <fullName>Active</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>InActive</fullName>
                <default>false</default>
            </values>
        </picklistValues>
    </recordTypes>
    <recordTypes>
        <fullName>CMC_Metrics</fullName>
        <active>true</active>
        <description>Daily collection of code/configuration metrics</description>
        <label>Salesforce Metrics</label>
        <picklistValues>
            <picklist>Frequency__c</picklist>
            <values>
                <fullName>Daily</fullName>
                <default>true</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>Last_Run_Status__c</picklist>
            <values>
                <fullName>Failed</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>Timeout</fullName>
                <default>false</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>Registered_State__c</picklist>
            <values>
                <fullName>Active</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>InActive</fullName>
                <default>false</default>
            </values>
        </picklistValues>
    </recordTypes>
    <recordTypes>
        <fullName>CMC_Monitor</fullName>
        <active>true</active>
        <description>Frequent monitor and notification of Apex Async Job conditions</description>
        <label>Salesforce Monitor (Async Job)</label>
        <picklistValues>
            <picklist>Frequency__c</picklist>
            <values>
                <fullName>Every 10 Minutes</fullName>
                <default>true</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>Last_Run_Status__c</picklist>
            <values>
                <fullName>Failed</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>Timeout</fullName>
                <default>false</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>Registered_State__c</picklist>
            <values>
                <fullName>Active</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>InActive</fullName>
                <default>false</default>
            </values>
        </picklistValues>
    </recordTypes>
    <recordTypes>
        <fullName>CMC_Monitor_Performance</fullName>
        <active>true</active>
        <description>Frequent performance monitor of certain system conditions</description>
        <label>Salesforce Monitor (Performance)</label>
        <picklistValues>
            <picklist>Frequency__c</picklist>
            <values>
                <fullName>Every 10 Minutes</fullName>
                <default>true</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>Last_Run_Status__c</picklist>
            <values>
                <fullName>Failed</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>Timeout</fullName>
                <default>false</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>Registered_State__c</picklist>
            <values>
                <fullName>Active</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>InActive</fullName>
                <default>false</default>
            </values>
        </picklistValues>
    </recordTypes>
    <searchLayouts>
        <customTabListAdditionalFields>Connection_Rel__c</customTabListAdditionalFields>
        <customTabListAdditionalFields>Account__c</customTabListAdditionalFields>
        <customTabListAdditionalFields>RECORDTYPE</customTabListAdditionalFields>
        <lookupDialogsAdditionalFields>Connection_Rel__c</lookupDialogsAdditionalFields>
        <lookupDialogsAdditionalFields>Account__c</lookupDialogsAdditionalFields>
        <lookupDialogsAdditionalFields>RECORDTYPE</lookupDialogsAdditionalFields>
        <lookupPhoneDialogsAdditionalFields>Connection_Rel__c</lookupPhoneDialogsAdditionalFields>
        <lookupPhoneDialogsAdditionalFields>Account__c</lookupPhoneDialogsAdditionalFields>
        <lookupPhoneDialogsAdditionalFields>RECORDTYPE</lookupPhoneDialogsAdditionalFields>
        <searchFilterFields>Connection_Rel__c</searchFilterFields>
        <searchFilterFields>Account__c</searchFilterFields>
        <searchFilterFields>RECORDTYPE</searchFilterFields>
        <searchResultsAdditionalFields>Connection_Rel__c</searchResultsAdditionalFields>
        <searchResultsAdditionalFields>Account__c</searchResultsAdditionalFields>
        <searchResultsAdditionalFields>RECORDTYPE</searchResultsAdditionalFields>
    </searchLayouts>
    <sharingModel>ControlledByParent</sharingModel>
    <validationRules>
        <fullName>Disallow_activating_deactivated_schedule</fullName>
        <active>true</active>
        <description>Activating a deactivating schedule is not allowed</description>
        <errorConditionFormula>AND (
  PRIORVALUE(Registered_State__c ) == &apos;InActive&apos;  , 
  ISCHANGED(Registered_State__c ) 
 )</errorConditionFormula>
        <errorDisplayField>Registered_State__c</errorDisplayField>
        <errorMessage>You are unable to reactivate an inactive schedule. Create a new schedule instead.</errorMessage>
    </validationRules>
    <webLinks>
        <fullName>Deactivate_Schedule</fullName>
        <availability>online</availability>
        <description>Deactivates the schedule.</description>
        <displayType>button</displayType>
        <height>600</height>
        <linkType>page</linkType>
        <masterLabel>Deactivate</masterLabel>
        <openType>sidebar</openType>
        <page>CMC_Delete_Schedule</page>
        <protected>false</protected>
    </webLinks>
    <webLinks>
        <fullName>Detail_Log</fullName>
        <availability>online</availability>
        <description>Detail log for debugging purpose</description>
        <displayType>button</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Detail Log</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <url>window.open(&apos;{!$Setup.CMC_URLs__c.Backend_Host__c}backyard/applicationLog?scheduleId={!CMC_Schedule__c.Id}&apos;)</url>
    </webLinks>
    <webLinks>
        <fullName>Run_Now</fullName>
        <availability>online</availability>
        <description>Run the schedule immidiately</description>
        <displayType>button</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Run Now</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <url>//adds the proper code for inclusion of AJAX toolkit 
{!REQUIRESCRIPT(&quot;/soap/ajax/23.0/connection.js&quot;)}
var lastRunStatus =&quot;{!CMC_Schedule__c.Last_Run_Status__c}&quot;;
var registeredState = &quot;{!CMC_Schedule__c.Registered_State__c}&quot;;
//alert(lastRunStatus);
var isBlockable = (lastRunStatus == &quot;In Progress&quot; ) || (lastRunStatus ==&quot;Timeout&quot; );
var isInactive = (registeredState == &quot;InActive&quot;) ;
if(isBlockable){
    alert(&apos;Unable to run now. This metrics job is already in progress.&apos;);
}
else if(isInactive ){
    alert(&apos;Unable to run an inactive schedule.&apos;);
}

else{
    // Session Id of Logged In User 
    var sessionId=sforce.connection.sessionId; 
    // server url 
    var hosturl = &quot;{!$Setup.CMC_URLs__c.Backend_Host__c}sfcp/p/scheduler/{!CMC_Schedule__c.Id}?cmd=run&amp;sessionId=&quot;+sessionId+&quot;&amp;connectionId={!CMC_Schedule__c.Connection_RelId__c}&quot;; 
    //alert(&apos;== hosturl  ==&apos;+hosturl );
    sforce.connection.remoteFunction({ 
        url : hosturl, 
        mimeType: &quot;text/plain&quot;, 
        method: &quot;POST&quot;, 
        onSuccess : function(response) { 
            // do nothing
           //alert(&quot;success&quot; + response);
        }, 
        onFailure : function(response) { 
            //do nothing
            //alert(&quot;failure&quot; + response);
        } 
    });
// Start Properties
var showDebugMessage = false;
var jQueryLoadAttempts = 0;
var waitProperties = {maxAttempts : 30, maxRestartAttempts: 4, iteration : 100, restartIteration : 1000}
// load JQuery
var staticResources = {jquery : &quot;/resource/CMC_jQuery/jquery/jquery.js&quot;};

function debugMessage(message){
if (showDebugMessage){
if(typeof(console) == &apos;undefined&apos;) { 
alert(message);
} else {
console.log(message);
}
}
} // end function debugMessage

// ajaxObject function found at: http://www.hunlock.com/blogs/Howto_Dynamically_Insert_Javascript_And_CSS
function ajaxObject(url, callbackFunction) {
debugMessage(&quot;Within ajaxObject&quot;); 
var that=this; 
this.updating = false;

this.update = function(passData,postMethod) { 
if (that.updating==true) { return false; }
that.updating=true; 
var AJAX = null; 
if (window.XMLHttpRequest) { 
AJAX=new XMLHttpRequest(); 
} else { 
AJAX=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);
} 
if (AJAX==null) { 
return false; 
} else {
AJAX.onreadystatechange = function() { 
if (AJAX.readyState==4) { 
that.updating=false; 
that.callback(AJAX.responseText,AJAX.status,AJAX.responseXML); 
delete AJAX; 
} 
} 
var timestamp = new Date(); 
if (postMethod==&apos;POST&apos;) {
var uri=urlCall+&apos;?&apos;+timestamp.getTime();
AJAX.open(&quot;POST&quot;, uri, true);
AJAX.setRequestHeader(&quot;Content-type&quot;, &quot;application/x-www-form-urlencoded&quot;);
AJAX.send(passData);
} else {
var uri=urlCall+&apos;?&apos;+passData+&apos;×tamp=&apos;+(timestamp*1); 
AJAX.open(&quot;GET&quot;, uri, true); 
AJAX.send(null); 
} 
return true; 
} 
}
var urlCall = url; 
this.callback = callbackFunction || function () { };
}

function attachjQueryScript(responseText, responseStatus) {
  debugMessage(&quot;Within attachjQueryScript&quot;);
    // This function is called by the ajaxObject when the server has finished 
// sending us the requested script.  
if (responseStatus==200) {   
eval(responseText);    
validateJQueryLoaded();  
}
}

// load jQuery
var getjQueryScriptViaAjax = new ajaxObject(staticResources.jquery, attachjQueryScript);
getjQueryScriptViaAjax.update();

function validateJQueryLoaded(){
debugMessage(&quot;Within validateJQueryLoaded&quot;); 
if(typeof(jQuery) == &apos;undefined&apos;) {
if (jQueryLoadAttempts &lt; waitProperties.maxAttempts) {
debugMessage(&quot;jQueryLoadAttempts = &quot; + jQueryLoadAttempts);
setTimeout(validateJQueryLoaded, (jQueryLoadAttempts++ * waitProperties.iteration));
} else {
alert(&quot;Error loading JQuery. Please refresh the page or try again&quot;);
} 
} else {
debugMessage(&apos;jQuery Loaded&apos;);
// JQuery Loaded
$(&quot;body&quot;).append(&quot;&lt;div class=&apos;spinnerMask&apos; id=&apos;spinnerMask&apos; style=&apos;position:fixed;left:0;top:0;background-color:#8d8d8d;height:100%;width:100%;opacity:0.6;filter:alpha(opacity=60);z-index:999;align:center;vertical-align:middle;&apos;&gt;&lt;div style=&apos;position: absolute; top: 35%;left:50%;opacity:1.0;filter:alpha(opacity=100);z-index:1000;background-color:#F5FCFF;width:204; height:94;border-radius:1em;border:1px solid #CEECFF;padding:20px 40px 20px 40px; &apos;&gt;&lt;img src=&apos;/img/analytics/reportbuilder/icons/spinner32.gif&apos; alt=&apos;Processing...&apos; style=&apos;width:32; height:32; align:center;&apos; title=&apos;Processing...&apos; /&gt;&amp;nbsp;&amp;nbsp;&lt;p style=&apos;display:inline;font-size:135%;font-weight:bold;&apos;&gt;Processing...&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&quot;);
setTimeout(function() { location.replace(&apos;/{!CMC_Schedule__c.Id}&apos;)}, 5000);
} 
} // end function validateJQueryLoaded
}</url>
    </webLinks>
    <webLinks>
        <fullName>Submit_Schedule</fullName>
        <availability>online</availability>
        <displayType>button</displayType>
        <hasMenubar>false</hasMenubar>
        <hasScrollbars>true</hasScrollbars>
        <hasToolbar>false</hasToolbar>
        <height>150</height>
        <isResizable>true</isResizable>
        <linkType>url</linkType>
        <masterLabel>Submit Schedule</masterLabel>
        <openType>newWindow</openType>
        <position>none</position>
        <protected>false</protected>
        <showsLocation>false</showsLocation>
        <showsStatus>false</showsStatus>
        <url>/apex/CMC_SubmitSchedule?scheduleId={!CMC_Schedule__c.Id}</url>
        <width>200</width>
    </webLinks>
</CustomObject>
